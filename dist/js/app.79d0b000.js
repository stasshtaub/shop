(function(t){function e(e){for(var a,o,i=e[0],c=e[1],u=e[2],p=0,d=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(d.length)d.shift()();return s.push.apply(s,u||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],a=!0,i=1;i<r.length;i++){var c=r[i];0!==n[c]&&(a=!1)}a&&(s.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},n={app:0},s=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var a=r("85ec"),n=r.n(a);n.a},"066c":function(t,e,r){"use strict";var a=r("189a"),n=r.n(a);n.a},1688:function(t,e,r){"use strict";var a=r("ce0e"),n=r.n(a);n.a},"189a":function(t,e,r){},"1cfd":function(t,e,r){},"2d3b":function(t,e,r){"use strict";var a=r("51fd"),n=r.n(a);n.a},"337d":function(t,e,r){"use strict";var a=r("4f24"),n=r.n(a);n.a},"427b":function(t,e,r){},"4f24":function(t,e,r){},"51fd":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"container",attrs:{id:"app"}},[r("myheader"),r("router-view")],1)},s=[],o=r("5530"),i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("header",[t.darkMode?r("link",{attrs:{rel:"stylesheet",href:"/assets/styles/dark.css"}}):t._e(),r("div",{staticClass:"left-panel"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.darkMode,expression:"darkMode"}],attrs:{type:"checkbox",id:"checkbox-dark"},domProps:{checked:Array.isArray(t.darkMode)?t._i(t.darkMode,null)>-1:t.darkMode},on:{change:[function(e){var r=t.darkMode,a=e.target,n=!!a.checked;if(Array.isArray(r)){var s=null,o=t._i(r,s);a.checked?o<0&&(t.darkMode=r.concat([s])):o>-1&&(t.darkMode=r.slice(0,o).concat(r.slice(o+1)))}else t.darkMode=n},t.toggleDarkMode]}}),r("label",{attrs:{for:"checkbox-dark"}})]),r("div",{staticClass:"right-panel"},[r("searchComponent"),t.IS_AUTHENTICATED?r("cart",{attrs:{dispComponent:t.dispComponent},on:{changeDispComponent:t.changeDispComponent}}):t._e(),t.GET_PROFILE?r("userComponent",{attrs:{dispComponent:t.dispComponent},on:{changeDispComponent:t.changeDispComponent}}):[r("router-link",{attrs:{id:"login",to:"/login"}},[t._v("Войти")]),r("router-link",{attrs:{id:"signup",to:"/signup"}},[t._v("Зарегистрироваться")])]],2)])},c=[],u=r("2f62"),l=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"wrapper"},[r("div",{staticClass:"profile-icon",style:{"background-image":"url("+t.GET_PROFILE.avatar+")"},on:{click:t.changeDispComponent}}),t.show?r("div",{staticClass:"profile-info"},[r("img",{staticClass:"profile__avatar",attrs:{src:t.GET_PROFILE.avatar}}),r("p",[t._v("Имя: "+t._s(t.GET_PROFILE.name))]),r("p",[t._v("Логин: "+t._s(t.GET_PROFILE.login))]),r("a",{attrs:{href:"",id:"logout"},on:{click:function(e){return e.preventDefault(),t.logout(e)}}},[t._v("Выйти")])]):t._e()])},p=[],d={name:"userComponent",props:{dispComponent:{type:Object,default:function(){return null}}},methods:Object(o["a"])({},Object(u["b"])(["AUTH_REQUEST","AUTH_LOGOUT"]),{logout:function(){this.AUTH_LOGOUT(),this.$store.unregisterModule("cartModule")},changeDispComponent:function(){this.$emit("changeDispComponent",this)}}),computed:Object(o["a"])({},Object(u["c"])(["GET_PROFILE","IS_AUTHENTICATED"]),{show:function(){return this.dispComponent===this}})},m=d,f=(r("066c"),r("2877")),h=Object(f["a"])(m,l,p,!1,null,"8525a432",null),_=h.exports,v=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart wrapper"},[r("div",{staticClass:"cart-icon",on:{click:t.changeDispComponent}},[r("div",{staticClass:"cart-icon__counter"},[r("span",[t._v(t._s(t.CART.length))])])]),t.show?r("div",{staticClass:"cart-content"},[t.CART.length?[r("div",{staticClass:"cart-list"},t._l(t.CART,(function(e,a){return r("cart-item",{key:e.pid,attrs:{cart_item:e},on:{remove:function(r){return t.REMOVE_FROM_CART({pid:e.pid,indexInCart:a})},changeCount:t.CHANGE_CART_ITEM_COUNT}})})),1),r("button",{staticClass:"order-button"},[t._v("Оформить заказ")])]:r("p",{staticClass:"empty-cart"},[t._v("Корзина пуста")])],2):t._e()])},T=[],C=(r("c740"),r("a434"),{SET_CART:function(t,e){t.cart=e},ADD_TO_CART:function(t,e){t.cart.push(e)},REMOVE_FROM_CART:function(t,e){var r=t.cart.findIndex((function(t){return t.pid==e.pid}));t.cart.splice(r,1)},CHANGE_CART_ITEM_COUNT:function(t,e){var r=e.cartItem,a=e.newCount;r.quantity=a}}),E=(r("99af"),r("d3b7"),r("bc3a")),g=r.n(E),O={GET_CART_FROM_API:function(t){var e=t.commit;return g.a.get("/api/cart/").then((function(t){switch(t.data.status){case"OK":e("SET_CART",t.data.items);break;default:console.log(t.data.status)}}))},ADD_TO_CART:function(t,e){var r=t.commit;return new Promise((function(t,a){g.a.post("/api/cart/","pid=".concat(e.pid)).then((function(e){switch(e.data.status){case"OK":r("ADD_TO_CART",e.data.item),t();break;default:a(e.data.status)}}))}))},REMOVE_FROM_CART:function(t,e){var r=t.commit;return new Promise((function(t,a){g.a.delete("/api/cart/",{params:{pid:e.pid}}).then((function(n){var s=n.data;switch(s.status){case"OK":r("REMOVE_FROM_CART",e),t();break;default:a(s.status)}}))}))},CHANGE_CART_ITEM_COUNT:function(t,e){var r=t.commit,a=e.cartItem,n=e.newCount;1<=n&&n<=a.count_product&&g.a.patch("/api/cart/","pid=".concat(a.pid,"&newCount=").concat(n)).then((function(t){var e=t.data;switch(e.status){case"OK":r("CHANGE_CART_ITEM_COUNT",{cartItem:a,newCount:n});break;default:console.log("Ошибка: "+e.status)}}))}},R={CART:function(t){return t.cart}},w={state:{cart:[]},mutations:C,actions:O,getters:R},b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"cart-item"},[r("div",{staticClass:"img-wrapper"},[r("img",{staticClass:"cart-item__img",attrs:{src:t.cart_item.img}})]),r("div",{staticClass:"cart-item__info"},[r("p",{staticClass:"cart-item__name"},[t._v(t._s(t.cart_item.name))]),r("p",{staticClass:"cart-item__price"},[t._v(t._s(t.cart_item.price*t.cart_item.quantity)+"р.")])]),r("div",{staticClass:"cart-item__controls"},[r("div",{staticClass:"cart_item_count-wrapper"},[r("button",{staticClass:"cart-item__count-minus",on:{click:function(e){return t.changeCount(t.cart_item.quantity-1)}}},[t._v("-")]),r("input",{directives:[{name:"model",rawName:"v-model",value:t.cart_item.quantity,expression:"cart_item.quantity"}],staticClass:"cart-item__count",attrs:{type:"number"},domProps:{value:t.cart_item.quantity},on:{input:function(e){e.target.composing||t.$set(t.cart_item,"quantity",e.target.value)}}}),r("button",{staticClass:"cart-item__count-plus",on:{click:function(e){t.changeCount(parseInt(t.cart_item.quantity)+1)}}},[t._v("+")])]),r("button",{staticClass:"cart-item__delete",on:{click:function(e){return t.$emit("remove")}}},[t._v("x")])])])},A=[],k={name:"cart-item",props:{cart_item:{type:Object,default:function(){return{}}}},mounted:function(){this.cart_item.quantity||this.$set(this.cart_item,"quantity",1)},methods:{changeCount:function(t){this.$emit("changeCount",{cartItem:this.cart_item,newCount:t})}}},S=k,I=(r("1688"),Object(f["a"])(S,b,A,!1,null,"2791183a",null)),P=I.exports,U={name:"cart",props:{dispComponent:{type:Object,default:function(){return null}}},components:{cartItem:P},computed:Object(o["a"])({},Object(u["c"])(["CART"]),{show:function(){return this.dispComponent===this}}),methods:Object(o["a"])({},Object(u["b"])(["GET_CART_FROM_API","REMOVE_FROM_CART","CHANGE_CART_ITEM_COUNT"]),{changeDispComponent:function(){this.$emit("changeDispComponent",this)}}),beforeMount:function(){this.$store.registerModule("cartModule",w),this.GET_CART_FROM_API()}},y=U,M=(r("cd58"),Object(f["a"])(y,v,T,!1,null,"31f273b1",null)),D=M.exports,F=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search-wrapper"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.search.query,expression:"search.query"}],staticClass:"search",attrs:{type:"search",name:"search",placeholder:"Поиск"},domProps:{value:t.search.query},on:{input:[function(e){e.target.composing||t.$set(t.search,"query",e.target.value)},t.gosearch]}}),t.search.result.length&&t.dispСomponent==t.$options.name?r("div",{staticClass:"search-result"},[r("ul",{staticClass:"search-result__list"},t._l(t.search.result,(function(e,a){return r("li",{key:a,staticClass:"search-result__item"},[r("img",{staticClass:"search-result__preview",attrs:{src:e.img}}),r("p",{staticClass:"search-result__name"},[t._v(t._s(e.name))])])})),0)]):t._e()])},j=[],x=(r("ac1f"),r("841c"),{props:{"dispСomponent":String},data:function(){return{search:{query:"",result:[]}}},methods:{gosearch:function(){var t=this;this.search.query?g.a.get("/api/",{params:{controller:"catalog",action:"search",data:[this.search.query]}}).then((function(e){switch(e.data.status){case"OK":t.search.result=e.data.data;break;default:console.log(e.data.status)}})).catch((function(t){console.log(t)})):this.search.result=[]}}}),H=x,L=(r("2d3b"),Object(f["a"])(H,F,j,!1,null,"19f1a729",null)),G=L.exports,N={data:function(){return{darkMode:"true"==localStorage.getItem("darkModeActive")||!1,dispComponent:null}},components:{userComponent:_,cart:D,searchComponent:G},computed:Object(o["a"])({},Object(u["c"])(["IS_AUTHENTICATED","GET_PROFILE"])),methods:{toggleDarkMode:function(){localStorage.setItem("darkModeActive",this.darkMode)},changeDispComponent:function(t){this.dispComponent!=t?this.dispComponent=t:this.dispComponent=null}}},$=N,q=(r("d5ec"),Object(f["a"])($,i,c,!1,null,"6ea32c33",null)),Q=q.exports,V={name:"App",components:{myheader:Q},mounted:function(){this.IS_AUTHENTICATED&&this.PROFILE_REQUEST()},computed:Object(o["a"])({},Object(u["c"])(["IS_AUTHENTICATED"])),methods:Object(o["a"])({},Object(u["b"])(["PROFILE_REQUEST"]))},K=V,z=(r("034f"),Object(f["a"])(K,n,s,!1,null,null,null)),J=z.exports,Y=r("8c4f"),Z=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"main"},[r("catalog")],1)},X=[],B=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",{staticClass:"catalog"},[r("div",{staticClass:"filters"},[t._l(t.FILTERS,(function(e,a){return r("div",{key:a,staticClass:"filters__wrapper filter"},[r("p",{staticClass:"filter__placeholder",on:{click:function(e){if(e.target!==e.currentTarget)return null;t.showFilter=a}}},[t._v(t._s(t.filters[a]||e.name))]),t.showFilter===a?r("div",{staticClass:"filter__values"},[r("p",{staticClass:"filter__value",on:{click:function(e){return e.target!==e.currentTarget?null:t.selectFilter(a,null)}}},[t._v("Все")]),t._l(e.values,(function(e){return r("p",{key:e.name,staticClass:"filter__value",on:{click:function(r){return t.selectFilter(a,e.name)}}},[t._v(t._s(e.name))])}))],2):t._e()])})),r("button",{staticClass:"filters__btn",on:{click:function(e){t.GET_PRODUCTS_FROM_API(t.selectedFilters())}}},[t._v("Отфильтровать")])],2),r("div",{staticClass:"items",attrs:{id:"items"}},t._l(t.checkedInCart,(function(e){return r("item",{key:e.pid,staticClass:"item",attrs:{item:e},on:{removeFromCart:function(r){return t.REMOVE_FROM_CART(e)},addToCart:function(r){return t.addToCart(e)}}})})),1)])},W=[],tt=(r("4160"),r("c975"),r("159b"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"item__image",style:{"background-image":"url('"+t.item.img+"')"}}),r("div",{staticClass:"item__description"},[r("p",{staticClass:"item__name"},[t._v(t._s(t.item.name))]),r("p",{staticClass:"item__price"},[t._v(t._s(t.item.price)+"р")])]),r("button",{staticClass:"item__button",class:{"in-cart":t.inCart},on:{click:function(e){return t.$emit(t.inCart?"removeFromCart":"addToCart")}}},[t._v(t._s(t.inCart?"В корзине":"+ В корзину"))])])}),et=[],rt={props:{item:Object},computed:{inCart:function(){return"indexInCart"in this.item}}},at=rt,nt=(r("dcb9"),Object(f["a"])(at,tt,et,!1,null,"2cef024d",null)),st=nt.exports,ot={components:{item:st},props:{cart:Object},data:function(){return{showFilter:"",filters:{}}},computed:Object(o["a"])({},Object(u["c"])(["PRODUCTS","FILTERS","CART","IS_AUTHENTICATED"]),{checkedInCart:function(){if(this.CART){var t=[];this.CART.forEach((function(e){t.push(e.pid)}));var e=[];return this.PRODUCTS.forEach((function(r){var a=t.indexOf(r.pid);-1!=a?e.push(Object(o["a"])({},r,{indexInCart:a})):e.push(r)})),e}return this.PRODUCTS}}),methods:Object(o["a"])({},Object(u["b"])(["GET_PRODUCTS_FROM_API","GET_FILTERS_FROM_API","ADD_TO_CART","REMOVE_FROM_CART"]),{addToCart:function(t){this.IS_AUTHENTICATED?this.ADD_TO_CART(t):this.$router.push("/login")},selectFilter:function(t,e){this.filters[t]=e,this.showFilter=""},selectedFilters:function(){var t={};for(var e in this.filters)this.filters[e]&&(t[e]=this.filters[e]);return t}}),mounted:function(){this.GET_PRODUCTS_FROM_API(),this.GET_FILTERS_FROM_API()}},it=ot,ct=(r("ba5c"),Object(f["a"])(it,B,W,!1,null,null,null)),ut=ct.exports,lt={name:"Main",components:{catalog:ut}},pt=lt,dt=(r("cbcc"),Object(f["a"])(pt,Z,X,!1,null,"7e1d951e",null)),mt=dt.exports,ft=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("form",{attrs:{id:"login-form"},on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[r("div",{staticClass:"input-wrapper"},[t.errors.username?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.username))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",name:"login",placeholder:"Логин"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.password?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.password))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.captcha?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.captcha))]):t._e(),r("vuerecaptcha",{attrs:{sitekey:"6LeheekUAAAAAPC5nUZ5g7udzHEpqYT77PQLmDyL",loadRecaptchaScript:!0},on:{verify:t.captchaVerifyHandler,expired:t.onCaptchaExpired}})],1),r("button",{attrs:{type:"submit"}},[t._v("Войти")])])])},ht=[],_t=r("e096"),vt={components:{vuerecaptcha:_t["a"]},data:function(){return{username:"",password:"",errors:{username:null,password:null,captcha:null},recaptchaToken:null}},computed:Object(o["a"])({},Object(u["c"])(["IS_AUTHENTICATED"])),methods:Object(o["a"])({},Object(u["b"])(["AUTH_REQUEST"]),{validate:function(){for(var t in this.errors)this.errors[t]=null;return this.username.length||(this.errors.username="Введите логин"),this.password.length||(this.errors.password="Введите пароль"),window.grecaptcha.getResponse()||(this.errors.captcha="Подтвердите, что вы не робот"),!this.errors.username&&!this.errors.password&&!this.errors.captcha},captchaVerifyHandler:function(t){this.recaptchaToken=t},onCaptchaExpired:function(){this.errors.captcha="Неверная каптча",window.grecaptcha.reset()},login:function(){var t=this;if(this.validate()){var e=this.username,r=this.password,a=this.recaptchaToken;this.AUTH_REQUEST({username:e,password:r,recaptchaToken:a}).then((function(){t.$router.push("/")})).catch((function(e){switch(window.grecaptcha.reset(),e.status){case"VALIDATE_ERROR":e.errors.username&&(t.errors.username=e.errors.username),e.errors.password&&(t.errors.password=e.errors.password),e.errors.captcha&&(t.errors.captcha=e.errors.captcha);break;case"USER_NOT_FOUND":t.errors.username="Неправильный логин и/или пароль";break;default:console.log(e.status)}}))}}}),mounted:function(){this.IS_AUTHENTICATED&&this.$router.push("/")}},Tt=vt,Ct=(r("fc30"),Object(f["a"])(Tt,ft,ht,!1,null,"2c302642",null)),Et=Ct.exports,gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("section",[r("form",{on:{submit:function(e){return e.preventDefault(),t.register(e)}}},[r("div",{staticClass:"input-wrapper"},[t.errors.name?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.name))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",name:"name",placeholder:"Имя"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.username?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.username))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",name:"login",placeholder:"Логин"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.password?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.password))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",name:"password",placeholder:"Пароль"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.confirmPassword?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.confirmPassword))]):t._e(),r("input",{directives:[{name:"model",rawName:"v-model",value:t.confirmPassword,expression:"confirmPassword"}],attrs:{type:"password",name:"confirmPassword",placeholder:"Подтверждение пароля"},domProps:{value:t.confirmPassword},on:{input:function(e){e.target.composing||(t.confirmPassword=e.target.value)}}})]),r("div",{staticClass:"input-wrapper"},[t.errors.captcha?r("div",{staticClass:"errorTooltip"},[t._v(t._s(t.errors.captcha))]):t._e(),r("vuerecaptcha",{attrs:{sitekey:"6LeheekUAAAAAPC5nUZ5g7udzHEpqYT77PQLmDyL",loadRecaptchaScript:!0},on:{verify:t.captchaVerifyHandler,expired:t.onCaptchaExpired}})],1),r("button",{attrs:{type:"submit"}},[t._v("Зарегистрироваться")])])])},Ot=[],Rt=(r("b0c0"),{components:{vuerecaptcha:_t["a"]},data:function(){return{name:"",username:"",password:"",confirmPassword:"",errors:{name:null,username:null,password:null,confirmPassword:null,captcha:null},recaptchaToken:null}},computed:Object(o["a"])({},Object(u["c"])(["IS_AUTHENTICATED"])),methods:Object(o["a"])({},Object(u["b"])(["REGISTER_REQUEST"]),{validate:function(){for(var t in this.errors)this.errors[t]=null;return this.name.length||(this.errors.name="Введите имя"),this.username.length<6&&(this.errors.username="Минимум 6 символов"),this.password.length<6?this.errors.password="Минимум 6 символов":this.password!=this.confirmPassword&&(this.errors.confirmPassword="Пароли не совпадают"),window.grecaptcha.getResponse()||(this.errors.captcha="Подтвердите, что вы не робот"),!this.errors.name&&!this.errors.username&&!this.errors.password&&!this.errors.confirmPassword&&!this.errors.captcha},captchaVerifyHandler:function(t){this.recaptchaToken=t},register:function(){var t=this;if(this.validate()){var e=this.username,r=this.password,a=this.confirmPassword,n=this.name,s=this.recaptchaToken;this.REGISTER_REQUEST({username:e,password:r,confirmPassword:a,name:n,recaptchaToken:s}).then((function(){t.$router.push("/")})).catch((function(e){switch(window.grecaptcha.reset(),e.status){case"VALIDATE_ERROR":e.errors.username&&(t.errors.username=e.errors.username),e.errors.password?t.errors.password=e.errors.password:e.errors.confirmPassword&&(t.errors.confirmPassword=e.errors.confirmPassword),e.errors.name&&(t.errors.name=e.errors.name),e.errors.captcha&&(t.errors.captcha=e.errors.captcha);break;case"USER_ALREADY_EXIST":t.errors.username="Такой пользователь уже существует";break}}))}},onCaptchaExpired:function(){this.errors.captcha="Неверная каптча",window.grecaptcha.reset()}}),mounted:function(){this.IS_AUTHENTICATED&&this.$router.push("/")},created:function(){}}),wt=Rt,bt=(r("337d"),Object(f["a"])(wt,gt,Ot,!1,null,"a8db8ce2",null)),At=bt.exports;a["a"].use(Y["a"]);var kt=new Y["a"]({mode:"history",routes:[{path:"/",name:"main",component:mt},{path:"/login",name:"login",component:Et},{path:"/signup",name:"signup",component:At}]}),St=kt,It={REGISTER_REQUEST:function(t){t.status="loading"},AUTH_REQUEST:function(t){t.status="loading"},AUTH_SUCCESS:function(t,e){var r=e.token,a=e.profile;t.status="success",t.token=r,t.profile=a},AUTH_ERROR:function(t){t.status="error"},AUTH_LOGOUT:function(t){t.token=null,t.profile=null},PROFILE_SUCCESS:function(t,e){t.status="success",t.profile=e},PROFILE_ERROR:function(t,e){t.token=null,t.profile=null,t.status=e}},Pt=(r("3ca3"),r("ddb0"),r("2b3d"),{REGISTER_REQUEST:function(t,e){var r=t.commit,a=e.username,n=e.password,s=e.confirmPassword,o=e.name,i=e.recaptchaToken;return new Promise((function(t,e){r("REGISTER_REQUEST");var c=new URLSearchParams;c.append("username",a),c.append("password",n),c.append("confirmPassword",s),c.append("name",o),c.append("g-recaptcha-response",i),g.a.post("/api/registration",c).then((function(a){switch(a.data.status){case"OK":var n=a.data.token;localStorage.setItem("user-token",n),g.a.defaults.headers.common["Authorization"]=n,r("AUTH_SUCCESS",{token:n,profile:a.data.profile}),t(a.data);break;default:r("AUTH_ERROR",a.data.status),localStorage.removeItem("user-token"),e(a.data);break}})).catch((function(t){r("AUTH_ERROR",t),localStorage.removeItem("user-token"),e(t)}))}))},AUTH_REQUEST:function(t,e){var r=t.commit,a=e.username,n=e.password,s=e.recaptchaToken;return new Promise((function(t,e){r("AUTH_REQUEST");var o=new URLSearchParams;o.append("username",a),o.append("password",n),o.append("g-recaptcha-response",s),g.a.post("/api/autch",o).then((function(a){switch(a.data.status){case"OK":var n=a.data.token;localStorage.setItem("user-token",n),g.a.defaults.headers.common["Authorization"]=n,r("AUTH_SUCCESS",{token:n,profile:a.data.profile}),t(a.data);break;default:r("AUTH_ERROR",a.data.status),localStorage.removeItem("user-token"),e(a.data)}})).catch((function(t){r("AUTH_ERROR",t),localStorage.removeItem("user-token"),e(t)}))}))},AUTH_LOGOUT:function(t){var e=t.commit;return new Promise((function(t){e("AUTH_LOGOUT"),localStorage.removeItem("user-token"),delete g.a.defaults.headers.common["Authorization"],t()}))},PROFILE_REQUEST:function(t){var e=t.commit,r=t.dispatch;return new Promise((function(){e("PROFILE_REQUEST"),g.a.get("/api/user/getData/").then((function(t){switch(t.data.status){case"OK":e("PROFILE_SUCCESS",t.data.profile);break;default:e("PROFILE_ERROR",t.data.status),r("AUTH_LOGOUT")}})).catch((function(t){e("PROFILE_ERROR",t.message),r("AUTH_LOGOUT")}))}))}}),Ut={IS_AUTHENTICATED:function(t){return!!t.token},GET_PROFILE:function(t){return t.profile}},yt={state:{token:localStorage.getItem("user-token")||null,status:null,profile:null},mutations:It,actions:Pt,getters:Ut},Mt={SET_PRODUCTS:function(t,e){t.products=e},SET_FILTERS:function(t,e){t.filters=e}},Dt={GET_PRODUCTS_FROM_API:function(t){var e=t.commit,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return g.a.get("/api/catalog/?filters="+JSON.stringify(r)).then((function(t){var r=t.data;switch(r.status){case"OK":return e("SET_PRODUCTS",r.data),r.data;default:console.log(r.status)}}))},GET_FILTERS_FROM_API:function(t){var e=t.commit;return g.a.get("/api/filter/").then((function(t){switch(t.data.status){case"OK":e("SET_FILTERS",t.data.filters);break;default:console.log(t.data.status)}}))}},Ft={PRODUCTS:function(t){return t.products},FILTERS:function(t){return t.filters}},jt={state:{products:[],filters:{}},mutations:Mt,actions:Dt,getters:Ft};a["a"].use(u["a"]),a["a"].config.devtools=!0;var xt=new u["a"].Store({modules:{userModule:yt,catalogModule:jt}}),Ht=xt,Lt=localStorage.getItem("user-token");Lt&&(g.a.defaults.headers.common["Authorization"]=Lt),a["a"].config.devtools=!0,a["a"].config.productionTip=!1,new a["a"]({render:function(t){return t(J)},store:Ht,router:St}).$mount("#app")},"6dd5":function(t,e,r){},"85ec":function(t,e,r){},"8c94":function(t,e,r){},"9fd7":function(t,e,r){},ba5c:function(t,e,r){"use strict";var a=r("8c94"),n=r.n(a);n.a},cbcc:function(t,e,r){"use strict";var a=r("6dd5"),n=r.n(a);n.a},cd58:function(t,e,r){"use strict";var a=r("1cfd"),n=r.n(a);n.a},ce0e:function(t,e,r){},d5ec:function(t,e,r){"use strict";var a=r("9fd7"),n=r.n(a);n.a},dcb9:function(t,e,r){"use strict";var a=r("427b"),n=r.n(a);n.a},f6bd:function(t,e,r){},fc30:function(t,e,r){"use strict";var a=r("f6bd"),n=r.n(a);n.a}});
//# sourceMappingURL=app.79d0b000.js.map